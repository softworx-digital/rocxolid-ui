/*! RocXolid Document Composer v1.0.0 | Copyright (c) 2016-present Kademi (http://kademi.co) & 2020 softworx (hello@softworx.digital) */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("jquery"));else if("function"==typeof define&&define.amd)define(["jquery"],e);else{var n="object"==typeof exports?e(require("jquery")):e(t.jquery);for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}("undefined"!=typeof self?self:this,(function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(e,n){e.exports=t},function(t,e){function n(t,e,n){t.self===t?t.scrollTo(e,n):(t.scrollLeft=e,t.scrollTop=n)}function i(t){var e=t._scrollSettings;if(e){var o=e.maxSynchronousAlignments,a=function(t,e){var n,i,o,a,l,r,d,s=t.align,c=t.target.getBoundingClientRect(),u=s&&null!=s.left?s.left:.5,f=s&&null!=s.top?s.top:.5,g=s&&null!=s.leftOffset?s.leftOffset:0,p=s&&null!=s.topOffset?s.topOffset:0,m=u,h=f;if(t.isWindow(e))r=Math.min(c.width,e.innerWidth),d=Math.min(c.height,e.innerHeight),i=c.left+e.pageXOffset-e.innerWidth*m+r*m,o=c.top+e.pageYOffset-e.innerHeight*h+d*h,o-=p,a=(i-=g)-e.pageXOffset,l=o-e.pageYOffset;else{r=c.width,d=c.height,n=e.getBoundingClientRect();var v=c.left-(n.left-e.scrollLeft),b=c.top-(n.top-e.scrollTop);i=v+r*m-e.clientWidth*m,o=b+d*h-e.clientHeight*h,i-=g,o-=p,i=Math.max(Math.min(i,e.scrollWidth-e.clientWidth),0),o=Math.max(Math.min(o,e.scrollHeight-e.clientHeight),0),a=i-e.scrollLeft,l=o-e.scrollTop}return{x:i,y:o,differenceX:a,differenceY:l}}(e,t),l=Date.now()-e.startTime,r=Math.min(1/e.time*l,1);if(e.endIterations>=o)return n(t,a.x,a.y),t._scrollSettings=null,e.end("complete");var d=1-e.ease(r);if(n(t,a.x-a.differenceX*d,a.y-a.differenceY*d),l>=e.time)return e.endIterations++,i(t);!function(t){if("requestAnimationFrame"in window)return window.requestAnimationFrame(t);setTimeout(t,16)}(i.bind(null,t))}}function o(t){return t.self===t}function a(t,e,n,a){var l,r=!e._scrollSettings,d=e._scrollSettings,s=Date.now(),c={passive:!0};function u(t){e._scrollSettings=null,e.parentElement&&e.parentElement._scrollSettings&&e.parentElement._scrollSettings.end(t),n.debug&&console.log("Scrolling ended with type",t,"for",e),a(t),l&&(e.removeEventListener("touchstart",l,c),e.removeEventListener("wheel",l,c))}d&&d.end("canceled");var f=n.maxSynchronousAlignments;return null==f&&(f=3),e._scrollSettings={startTime:s,endIterations:0,target:t,time:n.time,ease:n.ease,align:n.align,isWindow:n.isWindow||o,maxSynchronousAlignments:f,end:u},"cancellable"in n&&!n.cancellable||(l=u.bind(null,"canceled"),e.addEventListener("touchstart",l,c),e.addEventListener("wheel",l,c)),r&&i(e),l}function l(t){return"pageXOffset"in t||(t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth)&&"hidden"!==getComputedStyle(t).overflow}function r(){return!0}function d(t){if(t.assignedSlot)return d(t.assignedSlot);if(t.parentElement)return"BODY"===t.parentElement.tagName?t.parentElement.ownerDocument.defaultView||t.parentElement.ownerDocument.ownerWindow:t.parentElement;if(t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e.host}}t.exports=function(t,e,n){if(t){"function"==typeof e&&(n=e,e=null),e||(e={}),e.time=isNaN(e.time)?1e3:e.time,e.ease=e.ease||function(t){return 1-Math.pow(1-t,t/2)};var i,o=d(t),s=1,c=e.validTarget||r,u=e.isScrollable;for(e.debug&&(console.log("About to scroll to",t),o||console.error("Target did not have a parent, is it mounted in the DOM?"));o;)if(e.debug&&console.log("Scrolling parent node",o),c(o,s)&&(u?u(o,l):l(o))&&(s++,i=a(t,o,e,f)),!(o=d(o))){f("complete");break}return i}function f(t){--s||n&&n(t)}}},function(t,e,n){},,function(t,e,n){n(1);KEditor.components.image={settingSidebarOpen:!1,settingEnabled:function(t,e){return e.is("[data-element-settings-url")},settingTitle:function(t,e){return t.options.locale.component.text.settingsTitle},initSettingForm:function(t,e,n){t.options;var i=t.options.rx,o=t.options.rxUtility;e.find(".keditor-meta-data");o.ajaxCall({rx:i,element:$(n),type:"get",url:e.data("elementSettingsUrl")})}}},function(t,e,n){n(1);KEditor.components.gallery={settingSidebarOpen:!1,settingEnabled:function(t,e){return e.is("[data-element-settings-url")},settingTitle:function(t,e){return t.options.locale.component.text.settingsTitle},initSettingForm:function(t,e,n){t.options;var i=t.options.rx,o=t.options.rxUtility;e.find(".keditor-meta-data");o.ajaxCall({rx:i,element:$(n),type:"get",url:e.data("elementSettingsUrl")})}}},function(t,e,n){n(1);KEditor.components["youtube-video"]={settingSidebarOpen:!1,settingEnabled:function(t,e){return e.is("[data-element-settings-url")},settingTitle:function(t,e){return t.options.locale.component.text.settingsTitle},initSettingForm:function(t,e,n){t.options;var i=t.options.rx,o=t.options.rxUtility;e.find(".keditor-meta-data");o.ajaxCall({rx:i,element:$(n),type:"get",url:e.data("elementSettingsUrl")})}}},,function(t,n,i){"use strict";i.r(n);i(2);var o=i(1);KEditor.components.generic={settingSidebarOpen:!0,settingEnabled:function(t,e){return e.is("[data-element-settings-url")},settingTitle:function(t,e){return t.options.locale.component.generic.settingsTitle},initSettingForm:function(t,e,n){t.options;var i=t.options.rx,o=t.options.rxUtility,a=e.find(".keditor-meta-data");o.ajaxCall({rx:i,element:$(n),type:"get",url:e.data("elementSettingsUrl")},(function(o){i.hasPlugin("loading-overlay")&&i.getPlugin("loading-overlay").hide($(n).closest(".ajax-overlay"));var l=$(o.form);i.bindPlugins(l),l.on("submit",(function(){return $(this).ajaxSubmit({beforeSubmit:function(t,e,n){i.hasPlugin("loading-overlay")&&i.getPlugin("loading-overlay").show(e.closest(".ajax-overlay"))},success:function(n,o,l,r){i.hasPlugin("loading-overlay")&&i.getPlugin("loading-overlay").hide(r.closest(".ajax-overlay")),i.getResponse().set(n).handle(null,{meta_data:function(n){var i=n?JSON.parse(atob(n)):{};if($.isEmptyObject(i))a.text(""),e.removeAttr("data-element-meta"),e.removeClass("meta-data-active");else{var o=$("<ul>");for(var l in i)o.append("<li>".concat(i[l].title,": ").concat(i[l].value,"</li>"));a.html(o),e.attr("data-element-meta",n),e.addClass("meta-data-active")}t.sidebarCloser.click()}})},error:function(t){i.handleAjaxError(t)}}),!1})),n.append(l).on("keydown",(function(e){switch(e.which){case 13:return l.submit(),!1;case 27:return t.sidebarCloser.click(),!1}})).find(":input:visible").first().focus()}))},init:function(t,e,n,i){var o=i.options,a=n.children(".keditor-component-content");a.on("input",(function(a){"function"==typeof o.onComponentChanged&&o.onComponentChanged.call(i,a,n),"function"==typeof o.onContainerChanged&&o.onContainerChanged.call(i,a,e,t),"function"==typeof o.onContentChanged&&o.onContentChanged.call(i,a,t)})),this.withEditables(i,t,n,a,this.bindEditor)},getContent:function(t,e,n){var i=t.find(".keditor-component-content"),o=t.find("[data-element-type]");if("raw"===n)l=i.html();else{var a={},l=$("<div>").addClass("content-container").attr("data-element-type",o.data("elementType")).attr("data-element-id",o.data("elementId")).attr("data-element-template",o.data("elementTemplate"));this.withEditables(e,null,t,i,this.getEditorContent,a),$.each(a,(function(t,e){$("<div>").addClass("editable-content").attr("data-name",t).html(e).appendTo(l)}))}return KEditor.log("Component [".concat(o.data("elementType"),"][").concat(o.data("elementId"),"] [").concat(n,"] content"),l),l},destroy:function(t,e){t.find(".keditor-component-content")},withEditables:function(t,e,n,i,o,a){var l=this,r=t.options.rx,d=[];i.find(".editable").each((function(s,c){try{var u=1==i.find(".editable").length;if(!u&&!$(c).is("[data-name]"))throw"[data-name] missing in editable element";if($(c).is("[data-name]")){if(d.includes($(c).data("name")))throw'[data-name="'.concat($(c).data("name"),"\"] already used in this component's editable elements");d.push($(c).data("name"))}o.call(l,t,e,n,i,c,u,a)}catch(t){console.error(t,c),r.hasPlugin("notification")&&r.getPlugin("notification").show(t,"error")}}))},bindEditor:function(t,n,i,a,l,r,d){var s=t.options.rx;$(l).prop("contenteditable",!0).attr("data-editable-id",this.makeEditableId(a,l,r)),s.hasPlugin("inline-editor")&&($(l).on("focus",(function(e){console.debug("%c [".concat($(l).data("editableId"),"] FOCUS"),"color: #d1ffa3;",l),o(l,{time:100}),s.getPlugin("inline-editor").findInstance(l)||s.getPlugin("inline-editor").inline(l,{},(function(e){console.debug("%c [CKEditor][".concat(e.name,"] BOUND to [").concat($(l).data("editableId"),"]"),"color: #d1ffa3;",e),e.on("instanceReady",(function(){$(".".concat(e.id)).addClass("animated").addClass("slideInLeft").addClass("speed-200").appendTo(t.wrapper),e.fire("focus"),"function"==typeof t.options.onComponentReady&&t.options.onComponentReady.call(n,i,l,e)}))}))})),$(l).on("blur",(function(){console.debug("%c [".concat($(l).data("editableId"),"] BLUR"),"color: #ffcc00;",l);var t=s.getPlugin("inline-editor").findInstance(l);t&&!t.rxModal||(t?console.debug("%c [CKEditor][".concat(t.name,"] of [").concat($(l).data("editableId"),"] BLUR, rxModal Opened, keeping..."),"color: #ffcc00;"):console.debug("%c [CKEditor] not initialized on [".concat($(l).data("editableId"),"]"),"color: #ff0000;",e))})))},getEditorContent:function(t,e,n,i,o,a,l){var r=t.options.rx,d=$(o).is("[data-name]")?$(o).data("name"):null;if(r.hasPlugin("inline-editor"))var s=r.getPlugin("inline-editor").findInstance(o)||r.getPlugin("inline-editor").inline(o);l[d]=void 0!==s?s.getData():$(o).html(),void 0!==s&&s.destroy()},destroyEditor:function(t,e,n,i,o,a,l){var r=t.options.rx;if(r.hasPlugin("inline-editor")){var d=r.getPlugin("inline-editor").findInstance(o);d&&d.destroy()}},makeEditableId:function(t,e,n){return n&&!$(e).is("[data-name]")?t.attr("id"):t.attr("id")+"-"+$(e).data("name")}};var a=i(1);KEditor.components.text={settingSidebarOpen:!0,settingEnabled:function(t,e){return e.is("[data-element-settings-url")},settingTitle:function(t,e){return t.options.locale.component.text.settingsTitle},initSettingForm:function(t,e,n){t.options;var i=t.options.rx,o=t.options.rxUtility,a=e.find(".keditor-meta-data");o.ajaxCall({rx:i,element:$(n),type:"get",url:e.data("elementSettingsUrl")},(function(o){i.hasPlugin("loading-overlay")&&i.getPlugin("loading-overlay").hide($(n).closest(".ajax-overlay"));var l=$(o.form);i.bindPlugins(l),l.on("submit",(function(){return $(this).ajaxSubmit({beforeSubmit:function(t,e,n){i.hasPlugin("loading-overlay")&&i.getPlugin("loading-overlay").show(e.closest(".ajax-overlay"))},success:function(n,o,l,r){i.hasPlugin("loading-overlay")&&i.getPlugin("loading-overlay").hide(r.closest(".ajax-overlay")),i.getResponse().set(n).handle(null,{meta_data:function(n){var i=n?JSON.parse(atob(n)):{};if($.isEmptyObject(i))a.text(""),e.removeAttr("data-element-meta"),e.removeClass("meta-data-active");else{var o=$("<ul>");for(var l in i)o.append("<li>".concat(i[l].title,": ").concat(i[l].value,"</li>"));a.html(o),e.attr("data-element-meta",n),e.addClass("meta-data-active")}t.sidebarCloser.click()}})},error:function(t){i.handleAjaxError(t)}}),!1})),n.append(l).on("keydown",(function(e){switch(e.which){case 13:return l.submit(),!1;case 27:return t.sidebarCloser.click(),!1}})).find(":input:visible").first().focus()}))},init:function(t,e,n,i){var o=i.options,a=n.children(".keditor-component-content");a.on("input",(function(a){"function"==typeof o.onComponentChanged&&o.onComponentChanged.call(i,a,n),"function"==typeof o.onContainerChanged&&o.onContainerChanged.call(i,a,e,t),"function"==typeof o.onContentChanged&&o.onContentChanged.call(i,a,t)})),this.withEditables(i,t,n,a,this.bindEditor)},getContent:function(t,e,n){var i=t.find(".keditor-component-content"),o=t.find("[data-element-type]");if("raw"===n)l=i.html();else{var a={},l=$("<div>").addClass("content-container").attr("data-element-type",o.data("elementType")).attr("data-element-id",o.data("elementId")).attr("data-element-template",o.data("elementTemplate"));this.withEditables(e,null,t,i,this.getEditorContent,a),$.each(a,(function(t,e){$("<div>").addClass("editable-content").attr("data-name",t).html(e).appendTo(l)}))}return KEditor.log("Component [".concat(o.data("elementType"),"][").concat(o.data("elementId"),"] [").concat(n,"] content"),l),l},destroy:function(t,e){t.find(".keditor-component-content")},withEditables:function(t,e,n,i,o,a){var l=this,r=t.options.rx,d=[];i.find(".editable").each((function(s,c){try{var u=1==i.find(".editable").length;if(!u&&!$(c).is("[data-name]"))throw"[data-name] missing in editable element";if($(c).is("[data-name]")){if(d.includes($(c).data("name")))throw'[data-name="'.concat($(c).data("name"),"\"] already used in this component's editable elements");d.push($(c).data("name"))}o.call(l,t,e,n,i,c,u,a)}catch(t){console.error(t,c),r.hasPlugin("notification")&&r.getPlugin("notification").show(t,"error")}}))},bindEditor:function(t,n,i,o,l,r,d){var s=t.options.rx;$(l).prop("contenteditable",!0).attr("data-editable-id",this.makeEditableId(o,l,r)),s.hasPlugin("inline-editor")&&($(l).on("focus",(function(e){console.debug("%c [".concat($(l).data("editableId"),"] FOCUS"),"color: #d1ffa3;",l),a(l,{time:100}),s.getPlugin("inline-editor").findInstance(l)||s.getPlugin("inline-editor").inline(l,{},(function(e){console.debug("%c [CKEditor][".concat(e.name,"] BOUND to [").concat($(l).data("editableId"),"]"),"color: #d1ffa3;",e),e.on("instanceReady",(function(){$(".".concat(e.id)).addClass("animated").addClass("slideInLeft").addClass("speed-200").appendTo(t.wrapper),e.fire("focus"),"function"==typeof t.options.onComponentReady&&t.options.onComponentReady.call(n,i,l,e)}))}))})),$(l).on("blur",(function(){console.debug("%c [".concat($(l).data("editableId"),"] BLUR"),"color: #ffcc00;",l);var t=s.getPlugin("inline-editor").findInstance(l);t&&!t.rxModal||(t?console.debug("%c [CKEditor][".concat(t.name,"] of [").concat($(l).data("editableId"),"] BLUR, rxModal Opened, keeping..."),"color: #ffcc00;"):console.debug("%c [CKEditor] not initialized on [".concat($(l).data("editableId"),"]"),"color: #ff0000;",e))})))},getEditorContent:function(t,e,n,i,o,a,l){var r=t.options.rx,d=$(o).is("[data-name]")?$(o).data("name"):null;if(r.hasPlugin("inline-editor"))var s=r.getPlugin("inline-editor").findInstance(o)||r.getPlugin("inline-editor").inline(o);l[d]=void 0!==s?s.getData():$(o).html(),void 0!==s&&s.destroy()},destroyEditor:function(t,e,n,i,o,a,l){var r=t.options.rx;if(r.hasPlugin("inline-editor")){var d=r.getPlugin("inline-editor").findInstance(o);d&&d.destroy()}},makeEditableId:function(t,e,n){return n&&!$(e).is("[data-name]")?t.attr("id"):t.attr("id")+"-"+$(e).data("name")}};var l=i(0),r=i.n(l);KEditor.components.photo={init:function(t,e,n,i){n.children(".keditor-component-content").find("img").css("display","inline-block")},settingSidebarOpen:!1,settingEnabled:!0,settingTitle:"Photo Settings",initSettingForm:function(t,e,n){var i=this;t.options;n.append('<form class="form-horizontal">   <div class="form-group">       <div class="col-sm-12">           <button type="button" class="btn btn-block btn-primary" id="photo-edit">Change Photo</button>           <input type="file" style="display: none" />       </div>   </div>   <div class="form-group">       <label for="photo-align" class="col-sm-12">Align</label>       <div class="col-sm-12">           <select id="photo-align" class="form-control">               <option value="left">Left</option>               <option value="center">Center</option>               <option value="right">Right</option>           </select>       </div>   </div>   <div class="form-group">       <label for="photo-style" class="col-sm-12">Style</label>       <div class="col-sm-12">           <select id="photo-style" class="form-control">               <option value="">None</option>               <option value="img-rounded">Rounded</option>               <option value="img-circle">Circle</option>               <option value="img-thumbnail">Thumbnail</option>           </select>       </div>   </div>   <div class="form-group">       <label for="photo-responsive" class="col-sm-12">Responsive</label>       <div class="col-sm-12">           <input type="checkbox" id="photo-responsive" />       </div>   </div>   <div class="form-group">       <label for="photo-width" class="col-sm-12">Width</label>       <div class="col-sm-12">           <input type="number" id="photo-width" class="form-control" />       </div>   </div>   <div class="form-group">       <label for="photo-height" class="col-sm-12">Height</label>       <div class="col-sm-12">           <input type="number" id="photo-height" class="form-control" />       </div>   </div></form>');var o=n.find("#photo-edit"),a=o.next();o.on("click",(function(t){t.preventDefault(),a.trigger("click")})),a.on("change",(function(){var o=this.files[0];if(/image/.test(o.type)){var a=new FileReader;a.addEventListener("load",(function(o){var a=e.find("img");a.attr("src",o.target.result),a.css({width:"",height:""}),a.load((function(){i.showSettingForm.call(i,n,e,t)}))})),a.readAsDataURL(this.files[0])}else alert("Your selected file is not photo!")})),n.find("#photo-align").on("change",(function(){e.find(".photo-panel").css("text-align",this.value)})),n.find("#photo-responsive").on("click",(function(){e.find("img")[this.checked?"addClass":"removeClass"]("img-responsive")})),n.find("#photo-style").on("change",(function(){var t=e.find("img"),n=this.value;t.removeClass("img-rounded img-circle img-thumbnail"),n&&t.addClass(n)}));var l=n.find("#photo-width"),r=n.find("#photo-height");l.on("change",(function(){var t=e.find("img"),n=+this.value,o=Math.round(n/i.ratio);n<=0&&(n=i.width,o=i.height,this.value=n),t.css({width:n,height:o}),r.val(o)})),r.on("change",(function(){var t=e.find("img"),n=+this.value,o=Math.round(n*i.ratio);n<=0&&(o=i.width,n=i.height,this.value=n),t.css({height:n,width:o}),l.val(o)}))},showSettingForm:function(t,e,n){var i=this,o=t.find("#photo-align"),a=t.find("#photo-responsive"),l=t.find("#photo-width"),d=t.find("#photo-height"),s=t.find("#photo-style"),c=e.find(".photo-panel"),u=c.find("img"),f=c.css("text-align");"right"===f&&"center"===f||(f="left"),u.hasClass("img-rounded")?s.val("img-rounded"):u.hasClass("img-circle")?s.val("img-circle"):u.hasClass("img-thumbnail")?s.val("img-thumbnail"):s.val(""),o.val(f),a.prop("checked",u.hasClass("img-responsive")),l.val(u.width()),d.val(u.height()),r()("<img />").attr("src",u.attr("src")).load((function(){i.ratio=this.width/this.height,i.width=this.width,i.height=this.height}))}};i(4),i(5),i(6)}])}));
//# sourceMappingURL=keditor-components.js.map